---
schema_id: '1.0'

sources:
  source:
    typename: source_tree.git
    path: $(env:SOURCE_PATH)

input_templates:
  source:
    $(sources:source_uid):
      is_components_source: true
      incorporated: false
      usages: ["testing", "building"]

spdx_templates:
  spdx:
    package:
      supplier: "Organization: VMware"
      originator: "Organization: VMware"
      license_declared: "Apache-2.0"
      license_concluded: "Apache-2.0"
      home_page: "https://github.com/vmware/go-vcloud-director"
      short_summary: "Golang SDK for VMware Cloud Director"
      detailed_description: "Golang SDK for VMware Cloud Director"

outputs:
  file(org=go-vcloud-director.vcd.vmware.com,name=linux_amd64,version=$(env:VERSION),build_id=$(env:BUILD_ID)):
    merge_input_templates:
      - source
    merge_spdx_template: spdx
    scanner_instances:
      - scanner: srpcli-go
        args: ["--go-mod=$(env:SOURCE_PATH)/go.mod", "--incorporated=false", "--usage=testing"]
      - scanner: srpcli-syft
        args: ["--scan-target=$(env:SOURCE_PATH)", "--incorporated=true", "--usage=functionality" ]
